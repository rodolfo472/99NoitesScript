<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Chat</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body { margin:0; background:#0f172a; color:white; font-family:Arial; }
header { background:#020617; padding:10px; text-align:center; }
.container { padding:10px; }
.contact {
  background:#020617;
  padding:10px;
  border-radius:8px;
  margin-bottom:6px;
}
input, button {
  width:100%;
  padding:10px;
  margin-top:6px;
  border-radius:8px;
  border:none;
}
button { background:#22c55e; }
</style>
</head>

<body>

<header>
  ðŸ‘¤ <span id="userInfo"></span>
</header>

<div class="container">

<h3>âž• Adicionar contato</h3>
<input id="novoNumero" placeholder="NÃºmero (ex: 829XXXXXXXX)">
<button onclick="addContato()">Adicionar</button>

<hr>

<h3>ðŸ’¬ Contatos</h3>
<div id="lista"></div>

<button onclick="sair()">ðŸšª Sair</button>

</div>

<script>
const meuNumero = localStorage.getItem("usuario_logado");
if (!meuNumero) location.href = "index.html";

const userData = JSON.parse(localStorage.getItem("user_" + meuNumero));
userInfo.innerText = `${userData.nome} (${userData.genero}) - ${meuNumero}`;

let contatos = JSON.parse(localStorage.getItem("contatos_" + meuNumero)) || [];

function render() {
  lista.innerHTML = "";
  contatos.forEach(num => {
    const data = JSON.parse(localStorage.getItem("user_" + num));
    const div = document.createElement("div");
    div.className = "contact";
    div.innerText = data
      ? `${data.nome} - ${num}`
      : `Contato ${num}`;
    lista.appendChild(div);
  });
}

function addContato() {
  const num = novoNumero.value.trim();

  if (!/^(82|79)9\d{8}$/.test(num)) {
    alert("NÃºmero invÃ¡lido");
    return;
  }

  if (num === meuNumero) {
    alert("Esse Ã© seu nÃºmero");
    return;
  }

  if (contatos.includes(num)) {
    alert("Contato jÃ¡ adicionado");
    return;
  }

  contatos.push(num);
  localStorage.setItem("contatos_" + meuNumero, JSON.stringify(contatos));
  novoNumero.value = "";
  render();
}

function sair() {
  localStorage.removeItem("usuario_logado");
  location.href = "index.html";
}

render();
</script>

</body>
</html>
